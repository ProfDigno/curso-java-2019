package BASEDATO;

import java.sql.Connection;
import java.sql.DriverManager;
import javax.swing.JOptionPane;
import org.postgresql.Driver;

/**
 *
 * @author Pc
 */
public class ConnPostgres {
    private static String PgDriver="org.postgresql.Driver";//driver del postgres
    private static String PgConexion="jdbc:postgresql";//driver de java para postgres
    private static String PgLocalhost="localhost";//la ip del servidor
    private static String PgPort="5435";//el puerto del servidor
    private static String PgNombreBD="bdstock_clase1";//el nombre de la base de dato
    private static String PgUsuario="postgres";//usuario del postgres de por defecto es postgres
    private static String PgContrasena="4650586";//la contrasena se establese en la hora instalar el postgres 
    /**
     * VARIABLE Connection se encarga de realizar la conexion 
     * el metodo es ConnectBD
     * @param mensaje es para montras el mensaje que confirma la conexion
     * @return 
     */
    public static Connection ConnectBD(boolean mensaje){
        String conexionString="";
        try {
            conexionString = " " + PgConexion + "://"+PgLocalhost+":"+PgPort+"/"+PgNombreBD+"";
            Class.forName(PgDriver);
            // se crea una variable connLocal de tipo Connection que se intentara conectar al servidor de base de dato
            Connection connLocal = DriverManager.getConnection(conexionString,PgUsuario,PgContrasena);         
            if(mensaje){
                //si mensaje es true se mostrara este mensaje o si es false no se muestra pero se conecta directamente
                JOptionPane.showMessageDialog(null,"--CONEXION ESTABLESIDO CORRECTAMENTE--\n"+PgDriver+"\n"+conexionString+"\n"+PgUsuario);
            }
            return connLocal;//en caso que la conexion estee correcto retorna por la propia funcion (ConnectBD) 
        } catch (Exception e) {
            // en la variable e de Exception no va retornar cual fue el problema de la conexion
            JOptionPane.showMessageDialog(null,"ERROR EN LA HORA DE CONECTARSE A LA BASE DE DATO\n"+conexionString+"\nError:"+e+"\nEL SISTEMA SE VA CERRAR",
                    "ERROR DE CONEXION",JOptionPane.ERROR_MESSAGE);
            System.exit(0);//cerramos todo el sistema en caso que se dee error en la conexion
            return null;//en caso de error retornamos un valor null sobre la funcion ConnectBD
        }
    }
}
